
<style type="text/css">

input#search_key{

	width: 50%;
	height: 40px;
	font-size: 130%;
	padding-left: 15px;
	margin-bottom: 20px;
	box-shadow: 5px;

}

header#horizontal_panel{

	background: rgb(246,248,249); /* Old browsers */
background: -moz-linear-gradient(top, rgba(246,248,249,1) 0%, rgba(229,235,238,1) 50%, rgba(215,222,227,1) 51%, rgba(245,247,249,1) 100%); /* FF3.6+ */
background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(246,248,249,1)), color-stop(50%,rgba(229,235,238,1)), color-stop(51%,rgba(215,222,227,1)), color-stop(100%,rgba(245,247,249,1))); /* Chrome,Safari4+ */
background: -webkit-linear-gradient(top, rgba(246,248,249,1) 0%,rgba(229,235,238,1) 50%,rgba(215,222,227,1) 51%,rgba(245,247,249,1) 100%); /* Chrome10+,Safari5.1+ */
background: -o-linear-gradient(top, rgba(246,248,249,1) 0%,rgba(229,235,238,1) 50%,rgba(215,222,227,1) 51%,rgba(245,247,249,1) 100%); /* Opera 11.10+ */
background: -ms-linear-gradient(top, rgba(246,248,249,1) 0%,rgba(229,235,238,1) 50%,rgba(215,222,227,1) 51%,rgba(245,247,249,1) 100%); /* IE10+ */
background: linear-gradient(to bottom, rgba(246,248,249,1) 0%,rgba(229,235,238,1) 50%,rgba(215,222,227,1) 51%,rgba(245,247,249,1) 100%); /* W3C */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f6f8f9', endColorstr='#f5f7f9',GradientType=0 ); /* IE6-9 */
	

	position: fixed;
	z-index: 10;
	width: 100%;

}

header#horizontal_panel ul li{
	display: inline;
	

}
header#horizontal_panel ul li a{
	text-decoration: none;
	padding: 6px;
	border: solid 1px #6DBDE2;
	background-color: white;
	color: black;
	border-radius: 5px;
	margin: 1px;

}

div#results_list{

	margin: 3%;

	/*
	border: solid 1px black ;
	*/
}

div.result{
	margin-left: 30%;
	margin-right: 30%;
	margin-top: 5px;
	padding: 20px;
	border-radius: 5px;
	background-color: #EAEFF1;
	border-radius: 5px;

}

div.result a{
	text-decoration: none;

}

ul#filter li{
	display: inline;
}

a.selected_filter{
	text-decoration: none;
	color: black;
}

a.unselected_filter{
	text-decoration: none;
	color: blue;
}


hr{
	width: 50%;
}

#developer_text{
	margin-top: 1000px;
	height: 1000px;
	margin-left: 20%;
	margin-right: 20%;

}


#about_text{
	margin-top: 1000px;
	height: 1000px;
}


</style>

<html>
	<head>
		<title>
			Scrape me
		</title>

		    <script src="jquery-1.8.3.min.js"></script>


			<script type="text/javascript">

				var search_results=null;

				$(document).ready(call_on_ready);				
				function call_on_ready(){
					$("input#search_key").keypress(function(event){
						//alert(event.which);

						if( event.which == 13 ){
							event.preventDefault();
							initiateSearch();
						}

					});
					
					$("#user_data_fetch_button").click(function(){

						/*
						reset();
						var loading = document.createElement("img");
						$(loading).attr("src","loading-vim.gif");//.attr("width","200").attr("height","200");

						$("div#results_count_filter").html(loading);
						var name = $("input#search_key").val();
						//alert(name);
						getUserData(name);
						*/
						initiateSearch();
					});

					$("ul#filter li a").click(function(){
						//alert($(this).attr("id"));

						if ( search_results == null )
							return;

						var filter_links = $('ul#filter li').find('a').attr("class","unselected_filter");
						$(this).attr("class","selected_filter");

						addUserResults($(this).attr("id"))
					});
				}

				function initiateSearch(){

						reset();
						var loading = document.createElement("img");
						$(loading).attr("src","loading-vim.gif");//.attr("width","200").attr("height","200");

						$("div#results_count_filter").html(loading);
						var name = $("input#search_key").val();
						//alert(name);
						getUserData(name);

				}

				function reset(){
					var node = document.getElementById("results_list");
						while (node.hasChildNodes()) {
			 				node.removeChild(node.lastChild);
						}
				}

				function getUserData(search_key)
				{

						var finalUrl='/user/'+search_key;
						//alert( "Fetching");// with "+image_id);
					     var req=$.ajax({
					                   type:"GET",
					                   url:finalUrl,
					                   //contentType: "application/json; charset=utf-8",
					                   dataType:"JSON",
					                   success: function(results_array){
					                   		search_results =  results_array[0].users;
                   							$("div#results_count").html(results_array[0].count+"&nbsp; results");

					                   		addUserResults("filter_all");
					                },
					               complete:function(jqXHR, textStatus) {
					                 // alert("request complete "+textStatus);
					               },
					              error: function(xhr, textStatus, errorThrown){
					                //  alert('request failed->'+textStatus);
					              }   
					              
					              
					     });  
				}

				function addUserResults(filter_type){
					reset();
					count = 0;
					results_array = search_results ;
					var result = document.createElement("div");
					
					var str="";
					for(i=0;i<results_array.length ; i++)
					{
						if(
							filter_type=="filter_all" 
							|| filter_type == "filter_paying" && results_array[i].is_paid>0 
							|| filter_type == "filter_uploaded" && results_array[i].has_video>0
							|| filter_type == "filter_staff" && results_array[i].has_featured_video>0
						) 
						{	count++;
							result = document.createElement("div");
							$(result).attr('class','result');
							var name = "<a href='"+results_array[i].url+"'>" +					results_array[i].name + "</a>"+"<BR>";
							var link_url = "<a href='"+results_array[i].url+"'>"+results_array[i].url+"</a>";
							var url = "URL :"+link_url + "<BR>";
							var has_video = "Uploaded? "+ (parseInt(results_array[i].has_video)>0?"Yes":"No")+ 
							"<BR>";
							var has_featured_video = "Staff pick ? : "+(parseInt(results_array[i].has_featured_video)>0?"Yes":"No")+ "<BR>";
							var isPaid  = "Paying ? : " + (parseInt(results_array[i].is_paid)>0?"Yes":"No")+ 
							"<BR>";

							$(result).html(name+isPaid + has_featured_video + has_video);
							//$(result).html(str);
							$("#results_list").append(result);
						}

					}

					$("div#results_count_filter").html(count+"&nbsp; filtered results out of ");
					
					
				}


			</script>
	</head>

	<header id="horizontal_panel">
		<ul>
			<li>
				<a href="#">Search</a>
			<li>
			<li>
				<a href="#">About </a>
			</li>

			<li>
				<a href="#developer"> Developer </a>
			</li>

		</ul>

	</header><BR>
<BR>
	<BR>

	<body>
		<center>
			<input name="search_key" id="search_key" placeholder="Vimeo user name">
			<input type="button" id="user_data_fetch_button" value = "Get results"> 
		


		<br>


		<ul id="filter">
			<li>
				Filter &nbsp; |	&nbsp;			
			</li>

			<li>
				<a id="filter_all" href="#">All</a>  &nbsp; |	&nbsp;
			</li>
			<li>
				<a id="filter_paying" href="#">Paying</a>  &nbsp; |	&nbsp;
			</li>	
			<li>
				<a id="filter_uploaded" href="#">Uploaded</a>  &nbsp; |	&nbsp;
			</li>
			
			<li>
				<a id="filter_staff" href="#">Staff pick</a>  
			</li>

		</ul>
<br><br>
<hr ></hr>

</center>
<br><br>

		<center>
						<div id="results_count_filter"></div>

			<div id="results_count"></div> 


		</center>

		<div id="results_list">
			

		</div>

		<div id="about_text">
		</div>

		
		<div id="developer_text">
			<a id="developer"></a><br><br><br>

			<h3> Developer </h3>

			<p>

			I used a Python script to crawl <a href="http://vimeo.com">vimeo</a> and store all the links and user data in <br>
			my local MySQL database. 

			After details of 5000+ users were acquired, the DJANGO application was built locally and then <br>
			deployed on Redhat PaaS ( Openshift ). <br><br>

			The local MySQL database was migrated to Amazon RDS MySQL using another Python script.<br><br>

			Even though there were options of using 
			<a href="https://pypi.python.org/pypi/BeautifulSoup/">Beautiful Soup</a> or 

			<a href="http://www.scrapy.org/">Scrapy</a>, I prefered experimenting with <br>
			my own low-level implementation of the user page scraping algorithm. <br><br>

			In brief : <br>

			<ul>
				<li> Scrape out each link starting from vimeo.com and saving it to the local MySQL 
				 database table called "LINK"</li>

				<li> Choose an unvisited link from the table "LINK" and scrape out all the links. 
					Recognise using the algorithm if the page is a user page. If yes, then save the user data into the "USER" table and proceed with the next unvisited link from the LINK table. 
				</li>

				<li>
					Continue the above steps till 5000+ user profiles have been scraped.
				</li>

				<li> Write the Django appliction with a REST-style API for requesting user info for all 
					matching user names ( and sub-strings ).
				</li>
				<li>
					Write the HTML+ CSS + Javascript web page where the user has an option to query 
					by user name ( full or partial ).<br><br>

				</li>

				<li>

					The request is made by an AJAX call and the response is parsed and shown in the web-page.
					The results are stored for re-presentation of the same data conditionally by filters.

				</li>




			</ul>



			</p>
		</div>
	</body>
</html>